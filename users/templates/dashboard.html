
{% extends 'base.html' %}
{% load static %}

{% block content %}

  
  <div class="text-center">
    <div class="row mb-3">
      <div class="col-md-3 col-xl-3 col-3">
          <div class="avtar avtar-s rounded-circle text-success bg-light-success">
            <i class="ti ti-wifi f-45"></i>
          </div>
          <div class='mt-3'>
              <h6 class="mb-1">WIFI</h6>
              <p class="mb-0 text-muted"> OFF </p>
          </div>
      </div>
      <div class="col-md-3 col-xl-3 col-3">
        <div class="avtar avtar-s rounded-circle text-warning bg-light-warning">
          <i class="ti ti-bulb f-45"></i>
        </div>
        <div class='mt-3'>
            <h6 class="mb-1">Bulb</h6>
            <p class="mb-0 text-muted">3 ON </p>
        </div>
      </div>
      <div class="col-md-3 col-xl-3 col-3">
        <div class="avtar avtar-s rounded-circle text-success bg-light-success">
          <i class="ti ti-device-cctv f-45"></i>
        </div>
        <div class='mt-3'>
              <h6 class="mb-1">CCTV</h6>
              <p class="mb-0 text-muted"> OFF </p>
          </div>
      </div>

      <div class="col-md-3 col-xl-3 col-3">
        <div class="avtar avtar-s rounded-circle text-warning bg-light-warning">
          <i class="ti ti-aperture f-45"></i>
        </div>
        <div class='mt-3'>
            <h6 class="mb-1">Fan</h6>
            <p class="mb-0 text-muted">3 ON </p>
        </div>
      </div>
    </div>
  </div>

  {% comment %} Rooms Secction {% endcomment %}
  <div class="card p-3">
    <div class="row text-center">
      <div class="room-list p-3">
        <div class="d-flex justify-content-between">
            <div>
              <span class="badge bg-light-primary border border-primary custom-badge">
                <h5>Rooms</h5>
              </span>
            </div>
            <div>See all</div>
        </div>
      </div>
    </div>
    <div class="row" id="room_container">
      <!-- Rooms will be injected here -->
    </div>
    <div class="d-flex justify-content-between">
        <div></div>
        <div>
          <span class="badge bg-light-primary border border-primary custom-badge"  id="openRoomModal">
            <h5>  <i class="ti ti-circle-plus">Add Room</i></h5> 
          </span>
        </div>
    </div>

    {% include "modal/room_create_modal.html" %}

  </div>

  {% comment %} <div class="row align-items-center">
    <div class="col-md-12 col-xl-4">
        <h5 class="mb-3">
          <span class="badge bg-light-primary border border-primary custom-badge">
            <h5>Living Room</h5>
          </span>
        </h5>
        <div class="card">
            <div class="list-group list-group-flush">
                <a href="#" class="list-group-item list-group-item-action">
                    <div class="d-flex">
                    <div class="flex-shrink-0">
                        <div id="livingRoomBulb" class="avtar avtar-s rounded-circle bg-light-dark">
                            <i class="ti ti-bulb f-18"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">Bulb</h6>
                            <p class="mb-0 text-muted">{% if bulb.status %} OFF {% else %} ON {% endif %}</P>
                        </div>
                        <div class="flex-shrink-0 text-end">
                            <div class="custom-switch-container">
                                <div id="customSwitch1" class="custom-switch {% if bulb.status %}on{% endif %}">
                                <span class="custom-switch-text-off">OFF</span>
                                <span class="custom-switch-text-on">ON</span>
                                </div>
                            </div>
                        </div>
                  
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-12 col-xl-4">
        <h5 class="mb-3">
            <div class="avtar avtar-s rounded-circle text-success bg-light-success">
                <i class="ti ti-box-model f-18"></i>
            </div>
            Kitchen
        </h5>
        <div class="card">
            <div class="list-group list-group-flush">
                <a href="#" class="list-group-item list-group-item-action">
                    <div class="d-flex">
                    <div class="flex-shrink-0">
                        <div id="kitchenBulb" class="avtar avtar-s rounded-circle bg-light-dark">
                            <i class="ti ti-bulb f-18"></i>
                            </div>
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h6 class="mb-1">Bulb</h6>
                            <p class="mb-0 text-muted">On</P>
                        </div>
                        <div class="flex-shrink-0 text-end">
                            <div class="custom-switch-container">
                                <div id="kitchenSwitch" class="custom-switch">
                                <span class="custom-switch-text-off">OFF</span>
                                <span class="custom-switch-text-on">ON</span>
                                </div>
                            </div>
                        </div>
                  
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="col-md-12 col-xl-4">
        <h5 class="mb-3">Transaction History</h5>
        <div class="card">
            <div class="list-group list-group-flush">
                <a href="#" class="list-group-item list-group-item-action">
                    <div class="d-flex">
                    <div class="flex-shrink-0">
                        <div class="avtar avtar-s rounded-circle text-danger bg-light-danger">
                        <i class="ti ti-settings f-18"></i>
                        </div>
                    </div>
                    <div class="flex-grow-1 ms-3">
                        <h6 class="mb-1">Order #988784</h6>
                        <p class="mb-0 text-muted">7 hours ago</P>
                    </div>
                    <div class="flex-shrink-0 text-end">
                        <h6 class="mb-1">- $682</h6>
                        <p class="mb-0 text-muted">16%</P>
                    </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

  </div> {% endcomment %}
{% endblock %}

{% block extra_js %}
  <script src="{% static 'room/room.js' %}"></script>
  <script>
    // Call loadRooms when page loads
    $(document).ready(function(){
        loadRooms();
    });

    function getRoomCardHTML(room) {
      // You can customize background images dynamically later
      const bgImage = room.image_url || "https://img.freepik.com/free-photo/luxury-hotel-bedroom-illuminated-by-modern-lamps-generated-by-ai_188544-27990.jpg?semt=ais_hybrid&w=740&q=80";
      const deviceCount = room.device_count || 0;

      return `
      <div class="col-md-6 col-xl-4 mb-3">
        <div class="card" style="
            height: 300px;
            background: url(${bgImage}) no-repeat center/cover;
            position: relative;
            color: white;
            text-align: center;
            border-radius: 13px;
        ">
          <div class="card-body">
            <button onclick="deleteRoom(${room.id})" class="btn btn-danger btn-sm">
             <i class="ti ti-cup"></i> Delete
            </button>
            <div class="room-text">
              <div class="d-flex justify-content-around">
                <div>
                  ${room.name}
                  <p class="mb-0 text-muted text-sm" style="color:white !important;">
                    ${deviceCount} Device Active
                  </p>
                </div>
                <div>
                  <div class="avtar avtar-s rounded-circle text-success bg-light-success">
                    <a href="{% url 'room' %}?room_id=${room.id}"> <i class="ti ti-arrow-up-right f-45"></i></a>  
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      `;
    }
  </script>
{% endblock %}